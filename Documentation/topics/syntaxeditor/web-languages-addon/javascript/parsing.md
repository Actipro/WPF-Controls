---
title: "Parsing and Parse Data"
page-title: "Parsing and Parse Data - JavaScript Language - SyntaxEditor Web Languages Add-on"
order: 3
---
# Parsing and Parse Data

The JavaScript language uses an advanced parser that has been constructed using the Actipro [LL(*) Parser Framework](../../ll-parser-framework/index.md), and provides functionality for building ASTs, reporting parse errors, and more.

The [ILLParseData](xref:ActiproSoftware.Text.Parsing.LLParser.ILLParseData) results returned by this parser are consumed by multiple other features of the language, such as code outlining, parse error display, etc.

## AST Construction

A complete AST of parsed documents is generated by the parser, comprised of the various type-specific AST nodes created for this language.  It is passed back in the [ILLParseData](xref:ActiproSoftware.Text.Parsing.LLParser.ILLParseData).[Ast](xref:ActiproSoftware.Text.Parsing.LLParser.ILLParseData.Ast) property.

The AST node classes are all defined in the [ActiproSoftware.Text.Languages.DotNet.Ast.Implementation](xref:ActiproSoftware.Text.Languages.DotNet.Ast.Implementation) namespace, while related enumerations and intefaces are defined in the [ActiproSoftware.Text.Languages.DotNet.Ast](xref:ActiproSoftware.Text.Languages.DotNet.Ast) namespace.

## Parse Errors

Parse errors are reported from the parser.  They are passed back in the [ILLParseData](xref:ActiproSoftware.Text.Parsing.LLParser.ILLParseData).[Errors](xref:ActiproSoftware.Text.Parsing.IParseErrorProvider.Errors) property.

The parser reports errors as it performs syntax and semantic analysis of document text.

When the language is used in a SyntaxEditor control, the parse errors will have squiggle lines under them and mouse hovering over the squiggle lines will show IntelliPrompt quick info tips with error descriptions.

Parse errors can also be consumed by applications that wish to show the parse errors in a tool window.

## Retrieving Parse Data

As long as an [ambient parse request dispatcher](../../text-parsing/parsing/parse-requests-and-dispatchers.md) has been set up, all parsing and validation is performed in a worker thread.  The processing occurs after any text changes are made to documents using the language.  Since the work occurs in a worker thread, the results are returned asynchronously and may not be in perfect sync with the document text.  Although since the parse data includes the [ITextSnapshot](xref:ActiproSoftware.Text.ITextSnapshot) instance that was parsed, if known, you can easily translate offsets from the parse data snapshot to the current snapshot in a SyntaxEditor view or document.

Once a parsing operation completes, the [ILLParseData](xref:ActiproSoftware.Text.Parsing.LLParser.ILLParseData) results are placed into the [ParseData](xref:ActiproSoftware.Text.ICodeDocument.ParseData) property of the document that was parsed and its [ParseDataChanged](xref:ActiproSoftware.Text.ICodeDocument.ParseDataChanged) event fires.  The latest parse data results can be obtained at any time from that property.

See the [Parsers](../../text-parsing/parsing/parsers.md) topic for more detailed information on the parsing workflow and parse data.

## Parsing a Text String

See the [Parsers](../../text-parsing/parsing/parsers.md) for details on how to easily parse a text string using a language's parser, such as this one.

## Grammar Options

The JavaScript grammar ([JavaScriptGrammar](xref:ActiproSoftware.Text.Languages.JavaScript.Implementation.JavaScriptGrammar) class) constructor can be passed an [IJavaScriptGrammarOptions](xref:ActiproSoftware.Text.Languages.JavaScript.IJavaScriptGrammarOptions) object that indicates options for the grammar's creation.  The [JavaScriptGrammarOptions](xref:ActiproSoftware.Text.Languages.JavaScript.Implementation.JavaScriptGrammarOptions) class implements this interface.

### Root Non-Terminal

The default options indicate that compilation unit should be the root non-terminal for the grammar.  However this can be altered via the [IJavaScriptGrammarOptions](xref:ActiproSoftware.Text.Languages.JavaScript.IJavaScriptGrammarOptions).[RootNonTerminal](xref:ActiproSoftware.Text.Languages.JavaScript.IJavaScriptGrammarOptions.RootNonTerminal) property.  The [JavaScriptGrammarRootNonTerminal](xref:ActiproSoftware.Text.Languages.JavaScript.JavaScriptGrammarRootNonTerminal) enumeration has a number of options for a root non-terminal, everything from expressions to statements.

Use this code to alter the root non-terminal for the grammar so that it tries to parse a single expression instead of a compilation unit:

```csharp
JavaScriptSyntaxLanguage language = new JavaScriptSyntaxLanguage();

JavaScriptGrammarOptions grammarOptions = new JavaScriptGrammarOptions();
grammarOptions.RootNonTerminal = JavaScriptGrammarRootNonTerminal.Expression;
			
JavaScriptGrammar grammar = new JavaScriptGrammar(grammarOptions);
language.RegisterParser(new JavaScriptParser(grammar));
```

> [!NOTE]
> The [SyntaxLanguageExtensions](xref:ActiproSoftware.Text.SyntaxLanguageExtensions).[RegisterParser](xref:ActiproSoftware.Text.SyntaxLanguageExtensions.RegisterParser*) method in the code snippet above is a helper extension method that gets added to [ISyntaxLanguage](xref:ActiproSoftware.Text.ISyntaxLanguage) objects when the `ActiproSoftware.Text` namespace is imported.  See the [Service Locator Architecture](../../language-creation/service-locator-architecture.md) topic for details on registering and retrieving various service object instances, both via extension methods and generically, as there are some additional requirements for using the extension methods.
